package com.mycompany.gestaofuncionarios.presenter;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JOptionPane;

import com.mycompany.gestaofuncionarios.DAO.FuncionarioSQLiteDAO;
import com.mycompany.gestaofuncionarios.model.Funcionario;
import com.mycompany.gestaofuncionarios.states.FuncionarioStates;
import com.mycompany.gestaofuncionarios.states.FuncionarioVisualizacaoStates;
import com.mycompany.gestaofuncionarios.view.ViewManterFuncionario;

public class ManterFuncionarioPresenter {
	private  Funcionario func;
	private ViewManterFuncionario viewManterFuncionario;
	private FuncionarioStates state;
	
	public ManterFuncionarioPresenter(final ViewManterFuncionario viewManterFuncionario, Funcionario func) {
		this.func = func;
		this.viewManterFuncionario = viewManterFuncionario;
		this.setFuncionarioState(new FuncionarioVisualizacaoStates(this));
		this.setBotoes();
		
	}
	
	public void setBotoes() {
		viewManterFuncionario.getBtnEditarFuncionario().addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
            	editarFunc();
            }
        });
		
		viewManterFuncionario.getBtnFecharManterFuniconario().addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
            	viewManterFuncionario.getFrame().setVisible(false);
            }
        });
		
		viewManterFuncionario.getBtnExcluirFuncionario().addActionListener(new ActionListener() {
			 public void actionPerformed(ActionEvent e) {
	            	if(excluirFunc()) {
	            		JOptionPane.showMessageDialog(null,"Funcionário excluído com sucesso!", "Atenção", JOptionPane.INFORMATION_MESSAGE);
	            	}else {
	            		JOptionPane.showMessageDialog(null,"Erro ao excluir funcionário!", "Erro", JOptionPane.ERROR_MESSAGE);
	            	}
	            }
		});
	}
	
	
	public void setFuncionarioState(FuncionarioStates funcState){
        this.state = funcState;
    }
	
	private boolean excluirFunc() {
		FuncionarioSQLiteDAO dao = new FuncionarioSQLiteDAO();
		return dao.excluirFuncionario(this.func.getFuncId());
	}
	
	public void editarFunc() {
		try {
			this.state.editar();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public Funcionario getFunc() {
		return func;
	}

	public ViewManterFuncionario getViewManterFuncionario() {
		return viewManterFuncionario;
	}
}
